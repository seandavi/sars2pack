<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Estimating the replication rate,  • sars2pack</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Estimating the replication rate, ">
<meta property="og:description" content="sars2pack">
<meta name="robots" content="noindex">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--><!-- Global site tag (gtag.js) - Google Analytics --><script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-4"></script><script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-4');
</script>
</head>
<body data-spy="scroll" data-target="#toc">
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sars2pack</a>
        <span class="version label label-danger" data-toggle="tooltip" data-placement="bottom" title="In-development version">0.0.54-5</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/add_a_dataset.html">How to add a new dataset to sars2pack</a>
    </li>
    <li>
      <a href="../articles/case_tracking.html">Case tracking datasets</a>
    </li>
    <li>
      <a href="../articles/datasets.html">Overview of available datasets</a>
    </li>
    <li>
      <a href="../articles/doMCMC.html">Building MCMC-based models of SI for SARS-Cov-2</a>
    </li>
    <li>
      <a href="../articles/index.html">Introduction to sars2pack</a>
    </li>
    <li>
      <a href="../articles/map_visualization.html">Geospatial visualization of COVID-19 datasets</a>
    </li>
    <li>
      <a href="../articles/more_visualization.html">Visualizing geographic COVID-19 trends without maps</a>
    </li>
    <li>
      <a href="../articles/overview.html">Exploring the COVID-19 pandemic using sars2pack</a>
    </li>
    <li>
      <a href="../articles/r0_estimates.html">Estimating the replication rate, </a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/seandavi/sars2pack">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1 data-toc-skip>Estimating the replication rate, <span class="math inline">\(R_0\)</span>
</h1>
                        <h4 class="author">Sean Davis <a href="mailto:seandavi@gmail.com">seandavi@gmail.com</a> and Vincent J. Carey, stvjc at channing.harvard.edu</h4>
            
            <h4 class="date">May 22, 2020</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/seandavi/sars2pack/blob/master/vignettes/r0_estimates.Rmd"><code>vignettes/r0_estimates.Rmd</code></a></small>
      <div class="hidden name"><code>r0_estimates.Rmd</code></div>

    </div>

    
    
<div id="the-replication-rate-r_0" class="section level1">
<h1 class="hasAnchor">
<a href="#the-replication-rate-r_0" class="anchor"></a>The Replication rate, <span class="math inline">\(R_0\)</span>
</h1>
<div id="learning-goals-and-objectives" class="section level2">
<h2 class="hasAnchor">
<a href="#learning-goals-and-objectives" class="anchor"></a>Learning goals and objectives</h2>
<ul>
<li>Gain an intuitive understanding of <span class="math inline">\(R_0\)</span>.</li>
<li>Know that the value of <span class="math inline">\(R_0\)</span> determines how quickly a disease spreads or is eliminated.</li>
<li>Name the three main drivers of <span class="math inline">\(R_0\)</span>
</li>
<li>Learn to estimate <span class="math inline">\(R_0\)</span> from data on the number of infections over time occurring in a population.</li>
</ul>
</div>
<div id="background" class="section level2">
<h2 class="hasAnchor">
<a href="#background" class="anchor"></a>Background</h2>
<p>The replication rate, <span class="math inline">\(R_0\)</span> is a central value in understanding the rate at which a disease is spreading in a susceptible population.</p>
<div id="what-is-r_0" class="section level3">
<h3 class="hasAnchor">
<a href="#what-is-r_0" class="anchor"></a>What is <span class="math inline">\(R_0\)</span>?</h3>
<p><span class="math inline">\(R_0\)</span> is pronounced “R naught.” The <span class="math inline">\(R_0\)</span> value is an estimate of the average number of people who will be infected by one contagious person. It specifically applies to a population of people who are susceptible to the disease (have not been vaccinated and are not immune). If a disease has an <span class="math inline">\(R_0\)</span> of 18, for example, a contagious person will transmit it to an average of 18 other people, assuming that all people in the community are susceptible.</p>
</div>
<div id="what-do-r_0-values-mean" class="section level3">
<h3 class="hasAnchor">
<a href="#what-do-r_0-values-mean" class="anchor"></a>What do <span class="math inline">\(R_0\)</span> values mean?</h3>
<p>The <span class="math inline">\(R_0\)</span> value of a disease is important to understanding the dynamics of disease spread. Depending on the <span class="math inline">\(R_0\)</span> value, a disease should follow one of three possible courses in the at-risk community.</p>
<ul>
<li>If <span class="math inline">\(R_0\)</span> is less than 1, each existing infection is spread on average to less than one additional person, leading to decline in the number of cases and eventual end to the spread.</li>
<li>If <span class="math inline">\(R_0\)</span> equals 1, each existing infection causes one new infection, leading to stable infection numbers without increase or decrease with time, on average.</li>
<li>If <span class="math inline">\(R_0\)</span> is more than 1, each existing infection leads to more than one infection, resulting in growth and potential for epidemic/pandemic conditions.</li>
</ul>
<p><em>Importantly, the disease-specific <span class="math inline">\(R_0\)</span> value pplies when each member of the community is fully vulnerable to the disease with</em>:</p>
<ul>
<li>no one vaccinated</li>
<li>no one immune</li>
<li>no way to control the spread of the disease</li>
</ul>
</div>
<div id="what-variables-contribute-to-r_0" class="section level3">
<h3 class="hasAnchor">
<a href="#what-variables-contribute-to-r_0" class="anchor"></a>What variables contribute to <span class="math inline">\(R_0\)</span>?</h3>
<p>Three main factors impact the <span class="math inline">\(R_0\)</span> value of a disease:</p>
<ul>
<li><p><em>Infectious period</em>: The time that an infected person can spread the disease varies from one disease to another. Additional factors such as age of the infected person may affect the period during which a person can infect others. A long period of infectiousness will contribute to a higher <span class="math inline">\(R_0\)</span> value.</p></li>
<li><p><em>Contact rate</em>: If a person who’s infected with a contagious disease comes into contact with many people who aren’t infected or vaccinated, the disease will spread more quickly. If that person remains at home, in a hospital, or otherwise quarantined while they’re contagious, the disease will spread more slowly. A high contact rate will contribute to a higher <span class="math inline">\(R_0\)</span> value. The corollary, that lower contact rate, can reduce <span class="math inline">\(R_0\)</span> is the basis for <a href="https://www.nytimes.com/article/flatten-curve-coronavirus.html">flattening the curve</a> through <a href="https://en.wikipedia.org/wiki/Social_distancing">social distancing</a>.</p></li>
<li><p><em>Mode of transmission</em>: Airborne illnesses tend to have a higher <span class="math inline">\(R_0\)</span> value than those spread through contact or through bodily fluids.</p></li>
</ul>
</div>
</div>
<div id="simulated-epidemic-model" class="section level2">
<h2 class="hasAnchor">
<a href="#simulated-epidemic-model" class="anchor"></a>Simulated epidemic model</h2>
<p><strong>TODO</strong>: plot of incidence along with <span class="math inline">\(R_0(t)\)</span></p>
<p>Following code conveyed by John Mallery, we have the following approach for estimating <span class="math inline">\(R_0\)</span> using a single realization of an epidemic simulation.</p>
<p>Note that there can be failures of <code>estimate.R</code> for certain inputs. We are working on that.</p>
<div class="sourceCode" id="cb1"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">sars2pack</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">R0</span>)
<span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">lubridate</span>)</pre></body></html></div>
<pre><code>## 
## Attaching package: 'lubridate'</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     date, intersect, setdiff, union</code></pre>
<div class="sourceCode" id="cb4"><html><body><pre class="r"><span class="co"># Generating an epidemic with given parameters</span>
<span class="no">mGT</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/generation.time.html">generation.time</a></span>(<span class="st">"gamma"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3</span>,<span class="fl">1.5</span>))
<span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span>(<span class="fl">5432</span>)  <span class="co"># always initialize when simulating!</span>
<span class="no">mEpid</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/sim.epid.html">sim.epid</a></span>(<span class="kw">epid.nb</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">GT</span><span class="kw">=</span><span class="no">mGT</span>, <span class="kw">epid.length</span><span class="kw">=</span><span class="fl">30</span>,
     <span class="kw">family</span><span class="kw">=</span><span class="st">"poisson"</span>, <span class="kw">R0</span><span class="kw">=</span><span class="fl">1.67</span>, <span class="kw">peak.value</span><span class="kw">=</span><span class="fl">500</span>)
<span class="no">mEpid</span> <span class="kw">&lt;-</span> <span class="no">mEpid</span>[,<span class="fl">1</span>]
<span class="co"># Running estimations</span>
<span class="no">est</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/estimate.R.html">estimate.R</a></span>(<span class="kw">epid</span><span class="kw">=</span><span class="no">mEpid</span>, <span class="kw">GT</span><span class="kw">=</span><span class="no">mGT</span>, <span class="kw">methods</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"EG"</span>,<span class="st">"ML"</span>,<span class="st">"TD"</span>), <span class="kw">begin</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">end</span><span class="kw">=</span><span class="fl">30</span>)</pre></body></html></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>## Warning in est.R0.TD(epid = c(1, 0, 1, 0, 1, 0, 2, 1, 2, 1, 7, 2, 3, 4, :
## Simulations may take several minutes.</code></pre>
<pre><code>## Warning in est.R0.TD(epid = c(1, 0, 1, 0, 1, 0, 2, 1, 2, 1, 7, 2, 3, 4, : Using
## initial incidence as initial number of cases.</code></pre>
<p>We modified the plotting function in <em><a href="https://CRAN.R-project.org/package=R0">R0</a></em> which was calling <code>dev.new</code> too often. Use <code>plot2</code>.</p>
<div class="sourceCode" id="cb8"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">2</span>))
<span class="kw pkg">sars2pack</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plot2.html">plot2</a></span>(<span class="no">est</span>)</pre></body></html></div>
<p><img src="r0_estimates_files/figure-html/lksim-1.png" width="700"></p>
<p>The <code>plotfit2</code> function is also useful. These fits look identical but they are not.</p>
<div class="sourceCode" id="cb9"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">2</span>))
<span class="kw pkg">sars2pack</span><span class="kw ns">::</span><span class="fu"><a href="../reference/plotfit2.html">plotfit2</a></span>(<span class="no">est</span>)</pre></body></html></div>
<p><img src="r0_estimates_files/figure-html/lksim2-1.png" width="700"></p>
</div>
<div id="real-data-examples" class="section level2">
<h2 class="hasAnchor">
<a href="#real-data-examples" class="anchor"></a>Real data examples</h2>
<div class="sourceCode" id="cb10"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">dplyr</span>)</pre></body></html></div>
<pre><code>## 
## Attaching package: 'dplyr'</code></pre>
<pre><code>## The following objects are masked from 'package:lubridate':
## 
##     intersect, setdiff, union</code></pre>
<pre><code>## The following object is masked from 'package:MASS':
## 
##     select</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     filter, lag</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     intersect, setdiff, setequal, union</code></pre>
<div class="sourceCode" id="cb16"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">magrittr</span>)</pre></body></html></div>
<p>Now we extract information from the time-series table and obtain estimates of <span class="math inline">\(R_0\)</span> under exponential growth.</p>
<div id="hubei-province" class="section level3">
<h3 class="hasAnchor">
<a href="#hubei-province" class="anchor"></a>Hubei Province</h3>
<p>We are able to use exponential growth and time-dependent models with this data, using generation time model from a recent <a href="https://annals.org/aim/fullarticle/2762808/incubation-period-coronavirus-disease-2019-covid-19-from-publicly-reported">Annals of Internal Medicine</a> paper.</p>
<p>The incidence data probably need smoothing, and the time-dependent model has unreasonable fluctuations.</p>
<div class="sourceCode" id="cb17"><html><body><pre class="r"><span class="no">dates</span> <span class="kw">=</span> <span class="kw pkg">lubridate</span><span class="kw ns">::</span><span class="fu"><a href="http://lubridate.tidyverse.org/reference/as_date.html">as_date</a></span>(<span class="fu"><a href="http://lubridate.tidyverse.org/reference/ymd.html">mdy</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">mar19df</span>)[-<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">1</span>:<span class="fl">4</span>)]))
<span class="no">hubdat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="../reference/get_series.html">get_series</a></span>(<span class="kw">province</span><span class="kw">=</span><span class="st">"Hubei"</span>, <span class="kw">country</span><span class="kw">=</span><span class="st">"China"</span>,
    <span class="kw">dataset</span><span class="kw">=</span><span class="kw pkg">sars2pack</span><span class="kw ns">::</span><span class="no"><a href="../reference/mar19df.html">mar19df</a></span>))
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">hubdat</span>) <span class="kw">=</span> <span class="no">dates</span>
<span class="no">mGT</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/generation.time.html">generation.time</a></span>(<span class="st">"gamma"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5.8</span>, <span class="fl">0.95</span>)) <span class="co"># from DOI 10.7326/M20-0504</span>
<span class="no">mGT</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/generation.time.html">generation.time</a></span>(<span class="st">"gamma"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">3.96</span>, <span class="fl">4.75</span>)) <span class="co"># from DOI 10.7326/M20-0504</span>
<span class="no">hubdat.filt</span> <span class="kw">=</span> <span class="fu"><a href="../reference/trim_leading_values.html">trim_leading_values</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">hubdat</span>[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="no">hubdat</span>)))
<span class="no">est.EG</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/estimate.R.html">estimate.R</a></span>(<span class="kw">epid</span><span class="kw">=</span><span class="no">hubdat.filt</span>, <span class="kw">GT</span><span class="kw">=</span><span class="no">mGT</span>,
    <span class="kw">methods</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"EG"</span>, <span class="st">"TD"</span>), <span class="kw">begin</span><span class="kw">=</span><span class="fl">1L</span>, <span class="kw">end</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">hubdat.filt</span>)))</pre></body></html></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<pre><code>## Warning in est.R0.TD(epid = c(`2020-01-22` = 444, `2020-01-23` = 0, `2020-01-24`
## = 105, : Simulations may take several minutes.</code></pre>
<pre><code>## Warning in est.R0.TD(epid = c(`2020-01-22` = 444, `2020-01-23` = 0, `2020-01-24`
## = 105, : Using initial incidence as initial number of cases.</code></pre>
<div class="sourceCode" id="cb21"><html><body><pre class="r"><span class="no">est.EG</span></pre></body></html></div>
<pre><code>## Reproduction number estimate using  Exponential Growth  method.
## R :  0.8190473[ 0.8164334 , 0.821658 ]
## 
## Reproduction number estimate using  Time-Dependent  method.
## 2.020789 0 3.0142 3.134995 3.32356 3.865543 1.596743 0 1.878637 2.079345 ...</code></pre>
<div class="sourceCode" id="cb23"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">2</span>), <span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>))
<span class="fu"><a href="../reference/plot2.html">plot2</a></span>(<span class="no">est.EG</span>)
<span class="fu"><a href="../reference/plotfit2.html">plotfit2</a></span>(<span class="no">est.EG</span>)</pre></body></html></div>
<p><img src="r0_estimates_files/figure-html/dohub-1.png" width="700"></p>
</div>
<div id="italy" class="section level3">
<h3 class="hasAnchor">
<a href="#italy" class="anchor"></a>Italy</h3>
<p>For Italy, only the EG model seems to work, with the Annals of Internal Medicine generation time model. It fits the data reasonably well, but the data seems to include a reporting gap.</p>
<div class="sourceCode" id="cb24"><html><body><pre class="r"><span class="no">itdat</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html">as.numeric</a></span>(<span class="fu"><a href="../reference/get_series.html">get_series</a></span>(<span class="kw">province</span><span class="kw">=</span><span class="st">""</span>, <span class="kw">country</span><span class="kw">=</span><span class="st">"Italy"</span>,
    <span class="kw">dataset</span><span class="kw">=</span><span class="kw pkg">sars2pack</span><span class="kw ns">::</span><span class="no"><a href="../reference/mar19df.html">mar19df</a></span>))
<span class="fu"><a href="https://rdrr.io/r/base/names.html">names</a></span>(<span class="no">itdat</span>) <span class="kw">=</span> <span class="no">dates</span>
<span class="no">itdat.filt</span> <span class="kw">=</span> <span class="fu"><a href="../reference/trim_leading_values.html">trim_leading_values</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">itdat</span>[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="no">itdat</span>)))
<span class="no">est.EG</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/estimate.R.html">estimate.R</a></span>(<span class="kw">epid</span><span class="kw">=</span><span class="no">itdat.filt</span>, <span class="kw">GT</span><span class="kw">=</span><span class="no">mGT</span>,
    <span class="kw">methods</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"EG"</span>), <span class="kw">begin</span><span class="kw">=</span><span class="fl">1L</span>, <span class="kw">end</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">itdat.filt</span>)))</pre></body></html></div>
<pre><code>## Waiting for profiling to be done...</code></pre>
<div class="sourceCode" id="cb26"><html><body><pre class="r"><span class="no">est.EG</span></pre></body></html></div>
<pre><code>## Reproduction number estimate using  Exponential Growth  method.
## R :  1.968466[ 1.957161 , 1.979874 ]</code></pre>
<div class="sourceCode" id="cb28"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/graphics/par.html">par</a></span>(<span class="kw">mfrow</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">2</span>,<span class="fl">1</span>), <span class="kw">mar</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">5</span>,<span class="fl">3</span>,<span class="fl">2</span>,<span class="fl">2</span>))
<span class="fu"><a href="../reference/plot2.html">plot2</a></span>(<span class="no">est.EG</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"Italy"</span>)
<span class="fu"><a href="../reference/plotfit2.html">plotfit2</a></span>(<span class="no">est.EG</span>, <span class="kw">main</span><span class="kw">=</span><span class="st">"Italy"</span>)</pre></body></html></div>
<p><img src="r0_estimates_files/figure-html/doit-1.png" width="700"></p>
</div>
<div id="new-york-city" class="section level3">
<h3 class="hasAnchor">
<a href="#new-york-city" class="anchor"></a>New York City</h3>
<div class="sourceCode" id="cb29"><html><body><pre class="r"><span class="no">nyt</span> <span class="kw">=</span> <span class="fu"><a href="../reference/nytimes_county_data.html">nytimes_county_data</a></span>() <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">county</span><span class="kw">==</span><span class="st">'New York City'</span> <span class="kw">&amp;</span> <span class="no">subset</span><span class="kw">==</span><span class="st">'confirmed'</span>) <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">date</span>)
<span class="no">nytdat</span> <span class="kw">=</span> <span class="no">nyt</span>$<span class="no">count</span>
<span class="co"># do we need to chop zeros off? Seems like not.</span>
<span class="no">nytdat.filt</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">nytdat</span>[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="no">nytdat</span>))
<span class="no">est</span> <span class="kw">&lt;-</span> <span class="fu"><a href="https://rdrr.io/pkg/R0/man/estimate.R.html">estimate.R</a></span>(<span class="kw">epid</span><span class="kw">=</span><span class="no">nytdat.filt</span>, <span class="kw">GT</span><span class="kw">=</span><span class="no">mGT</span>,
                  <span class="kw">methods</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="st">"EG"</span>,<span class="st">"TD"</span>,<span class="st">"ML"</span>), <span class="kw">begin</span><span class="kw">=</span><span class="fl">1L</span>, <span class="kw">end</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/integer.html">as.integer</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/length.html">length</a></span>(<span class="no">nytdat.filt</span>)))</pre></body></html></div>
<p>We can also use the package <em><a href="https://CRAN.R-project.org/package=EpiEstim">EpiEstim</a></em> to perform time-dependent <span class="math inline">\(R_0\)</span> calculations.</p>
<div class="sourceCode" id="cb30"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/library.html">library</a></span>(<span class="no">EpiEstim</span>)</pre></body></html></div>
<pre><code>## 
## Attaching package: 'EpiEstim'</code></pre>
<pre><code>## The following object is masked from 'package:sars2pack':
## 
##     estimate_R</code></pre>
<div class="sourceCode" id="cb33"><html><body><pre class="r"><span class="no">epiestim</span> <span class="kw">=</span> <span class="kw pkg">EpiEstim</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html">estimate_R</a></span>(<span class="no">nytdat.filt</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"parametric_si"</span>,
                                <span class="kw">config</span> <span class="kw">=</span> <span class="kw pkg">EpiEstim</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html">make_config</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                                    <span class="kw">mean_si</span> <span class="kw">=</span> <span class="fl">3.96</span>, <span class="kw">std_si</span> <span class="kw">=</span> <span class="fl">4.75</span>)))</pre></body></html></div>
<pre><code>## Default config will estimate R on weekly sliding windows.
##     To change this change the t_start and t_end arguments.</code></pre>
<div class="sourceCode" id="cb35"><html><body><pre class="r"><span class="fu"><a href="https://rdrr.io/r/base/invisible.html">invisible</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">epiestim</span>))</pre></body></html></div>
<p><img src="r0_estimates_files/figure-html/unnamed-chunk-4-1.png" width="700"></p>
</div>
</div>
<div id="italy-from-jhu-dataset" class="section level2">
<h2 class="hasAnchor">
<a href="#italy-from-jhu-dataset" class="anchor"></a>Italy from JHU dataset</h2>
<p>This example uses data</p>
<div class="sourceCode" id="cb36"><html><body><pre class="r"><span class="no">jhu</span> <span class="kw">=</span> <span class="fu"><a href="../reference/jhu_data.html">jhu_data</a></span>() <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/filter.html">filter</a></span>(<span class="no">CountryRegion</span><span class="kw">==</span><span class="st">'Italy'</span> <span class="kw">&amp;</span> <span class="fu"><a href="https://rdrr.io/r/base/NA.html">is.na</a></span>(<span class="no">ProvinceState</span>) <span class="kw">&amp;</span> <span class="no">subset</span><span class="kw">==</span><span class="st">'confirmed'</span>) <span class="kw">%&gt;%</span>
    <span class="kw pkg">dplyr</span><span class="kw ns">::</span><span class="fu"><a href="https://dplyr.tidyverse.org/reference/arrange.html">arrange</a></span>(<span class="no">date</span>)
<span class="no">jhucases</span> <span class="kw">=</span> <span class="no">jhu</span>$<span class="no">count</span>
<span class="co"># do we need to chop zeros off? Seems like not.</span>
<span class="no">jhucases.inc</span> <span class="kw">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="no">jhucases</span>[<span class="fl">1</span>], <span class="fu"><a href="https://rdrr.io/r/base/diff.html">diff</a></span>(<span class="no">jhucases</span>))
<span class="no">jhucases.inc</span>[<span class="no">jhucases.inc</span><span class="kw">&lt;</span><span class="fl">0</span>] <span class="kw">=</span> <span class="fl">0</span>
<span class="no">epiestim</span> <span class="kw">=</span> <span class="kw pkg">EpiEstim</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/estimate_R.html">estimate_R</a></span>(<span class="no">jhucases.inc</span>, <span class="kw">method</span> <span class="kw">=</span> <span class="st">"parametric_si"</span>,
                                <span class="kw">config</span> <span class="kw">=</span> <span class="kw pkg">EpiEstim</span><span class="kw ns">::</span><span class="fu"><a href="https://rdrr.io/pkg/EpiEstim/man/make_config.html">make_config</a></span>(<span class="fu"><a href="https://rdrr.io/r/base/list.html">list</a></span>(
                                                       <span class="kw">mean_si</span> <span class="kw">=</span> <span class="fl">3.96</span>, <span class="kw">std_si</span> <span class="kw">=</span> <span class="fl">4.75</span>)))</pre></body></html></div>
<pre><code>## Default config will estimate R on weekly sliding windows.
##     To change this change the t_start and t_end arguments.</code></pre>
<div class="sourceCode" id="cb38"><html><body><pre class="r"><span class="no">meanR</span> <span class="kw">=</span> <span class="no">epiestim</span>$<span class="no">R</span>$<span class="no">`Mean(R)`</span>
<span class="fu"><a href="https://rdrr.io/r/base/plot.html">plot</a></span>(<span class="no">meanR</span>, <span class="kw">type</span><span class="kw">=</span><span class="st">'l'</span>, <span class="kw">ylim</span><span class="kw">=</span><span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span>(<span class="fl">0</span>,<span class="fl">5</span>),<span class="kw">main</span><span class="kw">=</span><span class="st">'R(t) for Italy'</span>, <span class="kw">ylab</span><span class="kw">=</span><span class="st">'R'</span>, <span class="kw">xlab</span><span class="kw">=</span><span class="st">'date'</span>)
<span class="fu"><a href="https://rdrr.io/r/graphics/abline.html">abline</a></span>(<span class="kw">h</span><span class="kw">=</span><span class="fl">1</span>, <span class="kw">lty</span><span class="kw">=</span><span class="fl">2</span>)</pre></body></html></div>
<p><img src="r0_estimates_files/figure-html/unnamed-chunk-5-1.png" width="700"></p>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">

        <nav id="toc" data-toggle="toc"><h2 data-toc-skip>Contents</h2>
    </nav>
</div>

</div>



      <footer><div class="copyright">
  <p>Developed by Sean Davis, VJ Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.5.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
