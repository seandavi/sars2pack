<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Align case tracking locations (for example) to a common baseline — align_to_baseline • sars2pack</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->
<link href="https://cdnjs.cloudflare.com/ajax/libs/bootswatch/3.4.0/flatly/bootstrap.min.css" rel="stylesheet" crossorigin="anonymous" />


<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>




<meta property="og:title" content="Align case tracking locations (for example) to a common baseline — align_to_baseline" />
<meta property="og:description" content="When endeavoring to compare epidemic curves (cases vs date, for
example), particularly when making graphical displays, it is helpful
to set a &quot;time baseline&quot; that aligns where all the curves start." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->


<!-- Global site tag (gtag.js) - Google Analytics -->
<script async src="https://www.googletagmanager.com/gtag/js?id=UA-93043521-4"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'UA-93043521-4');
</script>


  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">sars2pack</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.99.20</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/overview.html">Getting Started</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/seandavi/sars2pack">
    <span class="fa fa-github"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Align case tracking locations (for example) to a common baseline</h1>
    <small class="dont-index">Source: <a href='https://github.com/seandavi/sars2pack/blob/master/R/align_to_baseline.R'><code>R/align_to_baseline.R</code></a></small>
    <div class="hidden name"><code>align_to_baseline.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>When endeavoring to compare epidemic curves (cases vs date, for
example), particularly when making graphical displays, it is helpful
to set a "time baseline" that aligns where all the curves start.</p>
    </div>

    <pre class="usage"><span class='fu'>align_to_baseline</span><span class='op'>(</span><span class='va'>df</span>, <span class='va'>filter_criteria</span>, date_column <span class='op'>=</span> <span class='st'>"date"</span>, <span class='va'>group_vars</span><span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>df</th>
      <td><p>data.frame that includes a date column and at least one other column
for filtering, typically a case count.</p></td>
    </tr>
    <tr>
      <th>filter_criteria</th>
      <td><p>an expression as would normally be specified
directly to <code><a href='https://dplyr.tidyverse.org/reference/filter.html'>dplyr::filter()</a></code>.</p></td>
    </tr>
    <tr>
      <th>date_column</th>
      <td><p>character(1) column name of the column for ordering
the data to define a "beginning" of the curve. It is called a
"date column", but anything with a natural ordering will likely work.</p></td>
    </tr>
    <tr>
      <th>group_vars</th>
      <td><p>optional character() column_name(s) that specify
grouping done before calculating minimum <code>date</code>s. Concretely,
if the goal is to compare several countries, then the group_vars='country'
with a column in <code>df</code> called <code>country</code>.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>A data.frame with a new column, <code>index</code>, that gives the
number of time intervals (typically days) from when the
baseline counts are first encountered, done by group.</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>This function takes this basic approach:</p><ol>
<li><p>Filter all all data using the <code>filter_criteria</code>, expressed as a
<code><a href='https://dplyr.tidyverse.org/reference/filter.html'>dplyr::filter()</a></code> expression.</p></li>
<li><p>Optionally group the dataset.</p></li>
<li><p>Find the minimum date left after applying the filter criteria</p></li>
<li><p>"Subtract" the minimum date (on a per group basis if grouping
columns are used).</p></li>
</ol>

<p>The result is a plot that shifts all the curves to start at the "same"
starting time with respect to the "start" of the pandemic. For example,
for the COVID-19 pandemic, China started much earlier than the rest of
the world. To compare the time course of China versus other countries,
setting the time to the point where each country had 100 cases allows
direct comparison of the shapes of the countries' curves.</p>
    <h2 class="hasAnchor" id="see-also"><a class="anchor" href="#see-also"></a>See also</h2>

    <div class='dont-index'><p>Other case-tracking: 
<code><a href='beoutbreakprepared_data.html'>beoutbreakprepared_data</a>()</code>,
<code><a href='bulk_estimate_Rt.html'>bulk_estimate_Rt</a>()</code>,
<code><a href='combined_us_cases_data.html'>combined_us_cases_data</a>()</code>,
<code><a href='coronadatascraper_data.html'>coronadatascraper_data</a>()</code>,
<code><a href='covidtracker_data.html'>covidtracker_data</a>()</code>,
<code><a href='ecdc_data.html'>ecdc_data</a>()</code>,
<code><a href='estimate_Rt.html'>estimate_Rt</a>()</code>,
<code><a href='jhu_data.html'>jhu_data</a>()</code>,
<code><a href='nytimes_county_data.html'>nytimes_county_data</a>()</code>,
<code><a href='owid_data.html'>owid_data</a>()</code>,
<code><a href='plot_epicurve.html'>plot_epicurve</a>()</code>,
<code><a href='test_and_trace_data.html'>test_and_trace_data</a>()</code>,
<code><a href='usa_facts_data.html'>usa_facts_data</a>()</code>,
<code><a href='who_cases.html'>who_cases</a>()</code></p>
<p>Other plotting: 
<code><a href='plot_epicurve.html'>plot_epicurve</a>()</code></p></div>
    <h2 class="hasAnchor" id="author"><a class="anchor" href="#author"></a>Author</h2>

    <p>Sean Davis <a href='mailto:seandavi@gmail.com'>seandavi@gmail.com</a></p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://dplyr.tidyverse.org'>dplyr</a></span><span class='op'>)</span>
<span class='kw'><a href='https://rdrr.io/r/base/library.html'>library</a></span><span class='op'>(</span><span class='va'><a href='https://ggplot2.tidyverse.org'>ggplot2</a></span><span class='op'>)</span>

<span class='co'># use European CDC dataset</span>
<span class='va'>ecdc</span> <span class='op'>=</span> <span class='fu'><a href='ecdc_data.html'>ecdc_data</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='va'>ecdc</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 6 x 12</span>
#&gt; <span style='color: #949494;'># Groups:   location_name, subset [6]</span>
#&gt;   date         day month  year location_name iso2c iso3c population_2019
#&gt;   <span style='color: #949494; font-style: italic;'>&lt;date&gt;</span>     <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>         <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span>           <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span>
#&gt; <span style='color: #BCBCBC;'>1</span> 2019-12-31    31    12  <span style='text-decoration: underline;'>2</span>019 Afghanistan   AF    AFG          38<span style='text-decoration: underline;'>041</span>757
#&gt; <span style='color: #BCBCBC;'>2</span> 2019-12-31    31    12  <span style='text-decoration: underline;'>2</span>019 Afghanistan   AF    AFG          38<span style='text-decoration: underline;'>041</span>757
#&gt; <span style='color: #BCBCBC;'>3</span> 2019-12-31    31    12  <span style='text-decoration: underline;'>2</span>019 Algeria       DZ    DZA          43<span style='text-decoration: underline;'>053</span>054
#&gt; <span style='color: #BCBCBC;'>4</span> 2019-12-31    31    12  <span style='text-decoration: underline;'>2</span>019 Algeria       DZ    DZA          43<span style='text-decoration: underline;'>053</span>054
#&gt; <span style='color: #BCBCBC;'>5</span> 2019-12-31    31    12  <span style='text-decoration: underline;'>2</span>019 Armenia       AM    ARM           2<span style='text-decoration: underline;'>957</span>728
#&gt; <span style='color: #BCBCBC;'>6</span> 2019-12-31    31    12  <span style='text-decoration: underline;'>2</span>019 Armenia       AM    ARM           2<span style='text-decoration: underline;'>957</span>728
#&gt; <span style='color: #949494;'># … with 4 more variables: continent &lt;chr&gt;,</span>
#&gt; <span style='color: #949494;'>#   Cumulative_number_for_14_days_of_COVID-19_cases_per_100000 &lt;dbl&gt;,</span>
#&gt; <span style='color: #949494;'>#   subset &lt;chr&gt;, count &lt;dbl&gt;</span></div><div class='input'><span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://pillar.r-lib.org/reference/glimpse.html'>glimpse</a></span><span class='op'>(</span><span class='va'>ecdc</span><span class='op'>)</span>
</div><div class='output co'>#&gt; Rows: 123,800
#&gt; Columns: 12
#&gt; Groups: location_name, subset [428]
#&gt; $ date                                                         <span style='color: #949494; font-style: italic;'>&lt;date&gt;</span> 2019-12-…
#&gt; $ day                                                          <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> 31, 31, 3…
#&gt; $ month                                                        <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> 12, 12, 1…
#&gt; $ year                                                         <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> 2019, 201…
#&gt; $ location_name                                                <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> "Afghanis…
#&gt; $ iso2c                                                        <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> "AF", "AF…
#&gt; $ iso3c                                                        <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> "AFG", "A…
#&gt; $ population_2019                                              <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> 38041757,…
#&gt; $ continent                                                    <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> "Asia", "…
#&gt; $ `Cumulative_number_for_14_days_of_COVID-19_cases_per_100000` <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> NA, NA, N…
#&gt; $ subset                                                       <span style='color: #949494; font-style: italic;'>&lt;chr&gt;</span> "cases", …
#&gt; $ count                                                        <span style='color: #949494; font-style: italic;'>&lt;dbl&gt;</span> 0, 0, 0, …</div><div class='input'>
<span class='co'># get top 10 countries by cumulative</span>
<span class='co'># number of deaths</span>
<span class='va'>top_10</span> <span class='op'>=</span> <span class='va'>ecdc</span> <span class='op'>%&gt;%</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>subset</span><span class='op'>==</span><span class='st'>'deaths_weekly'</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/group_by.html'>group_by</a></span><span class='op'>(</span><span class='va'>location_name</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/summarise.html'>summarize</a></span><span class='op'>(</span>deaths <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>max</a></span><span class='op'>(</span><span class='va'>count</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/arrange.html'>arrange</a></span><span class='op'>(</span><span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/desc.html'>desc</a></span><span class='op'>(</span><span class='va'>deaths</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
    <span class='fu'><a href='https://rdrr.io/r/utils/head.html'>head</a></span><span class='op'>(</span><span class='fl'>10</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: no non-missing arguments to max; returning -Inf</span></div><div class='input'>
<span class='va'>top_10</span>
</div><div class='output co'>#&gt; <span style='color: #949494;'># A tibble: 0 x 2</span>
#&gt; <span style='color: #949494;'># … with 2 variables: location_name &lt;chr&gt;, deaths &lt;dbl&gt;</span></div><div class='input'>
<span class='co'># limit ecdc data to "deaths" and</span>
<span class='co'># top 10 countries</span>

<span class='va'>ecdc_top10</span> <span class='op'>=</span> <span class='va'>ecdc</span> <span class='op'>%&gt;%</span>
    <span class='fu'>dplyr</span><span class='fu'>::</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/filter.html'>filter</a></span><span class='op'>(</span><span class='va'>location_name</span> <span class='op'>%in%</span> <span class='va'>top_10</span><span class='op'>[[</span><span class='st'>'location_name'</span><span class='op'>]</span><span class='op'>]</span> <span class='op'>&amp;</span> <span class='va'>subset</span><span class='op'>==</span><span class='st'>'deaths_weekly'</span><span class='op'>)</span>
<span class='fu'><a href='plot_epicurve.html'>plot_epicurve</a></span><span class='op'>(</span><span class='va'>ecdc_top10</span>, color<span class='op'>=</span><span class='st'>'location_name'</span>, case_column<span class='op'>=</span><span class='st'>'count'</span><span class='op'>)</span>
</div><div class='img'><img src='align_to_baseline-1.png' alt='' width='700' height='433' /></div><div class='input'>
<span class='va'>ecdc_top10_baseline</span> <span class='op'>=</span> <span class='fu'>align_to_baseline</span><span class='op'>(</span><span class='va'>ecdc_top10</span>, <span class='va'>count</span><span class='op'>&gt;</span><span class='fl'>100</span>, group_vars<span class='op'>=</span><span class='st'>'location_name'</span><span class='op'>)</span>
</div><div class='output co'>#&gt; <span class='warning'>Warning: no non-missing arguments to min; returning Inf</span></div><div class='input'>
<span class='fu'><a href='plot_epicurve.html'>plot_epicurve</a></span><span class='op'>(</span><span class='va'>ecdc_top10_baseline</span>, date_column<span class='op'>=</span><span class='st'>'index'</span>, color<span class='op'>=</span><span class='st'>'location_name'</span><span class='op'>)</span> <span class='op'>+</span>
    <span class='fu'><a href='https://ggplot2.tidyverse.org/reference/labs.html'>ggtitle</a></span><span class='op'>(</span><span class='st'>'Deaths over time, aligned to date of 100 deaths per country'</span><span class='op'>)</span> 
</div><div class='img'><img src='align_to_baseline-2.png' alt='' width='700' height='433' /></div><div class='input'>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Sean Davis, VJ Carey.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


